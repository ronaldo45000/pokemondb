<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App</title>

    <link rel="stylesheet" href="./assets/style2.css"> 

    <style>
        /* Add any additional styles as needed */
        #myModal {
            display: none;
        }

        /* Hide default fields and labels initially */
        #username, #password, #name, #age,#Pokemon1, #Pokemon1  {
            display: none;
        }

        /* Show specific fields and labels based on the search term */
        .user-fields, .people-fields,.pokemon-fields {
            display: block;
        }
    </style>
</head>
<body>

    <input type="text" id="searchInput" placeholder="Search Term">

    <button onclick="addButtonClick()" id="insert">Insert</button>
    <button onclick="deleteRow()" id="delete">Delete</button>

    <table id="myTable">
      <thead>
        <tr>
          <th>1</th>
          <th>2</th>
          <th>3</th>
        </tr>
      </thead>
      <tbody>
        <!-- Table rows will be added dynamically here -->
      </tbody>
    </table>

    <div id="myModal">
      <div id="modalContent">

        <label for="username" class="user-fields">Username:</label>
        <input type="text" id="username" class="user-fields"><br>
        
        <label for="password" class="user-fields">Password:</label>
        <input type="password" id="password" class="user-fields"><br>

        <!-- Additional fields based on the search term -->
        <label for="name" class="people-fields">Name:</label>
        <input type="text" id="name" class="people-fields"><br>
        
        <label for="age" class="people-fields">Age:</label>
        <input type="text" id="age" class="people-fields"><br>
        <!-- Additional fields based on the search term -->

        <label for="Pokemon1" class="pokemon-fields">Pokemon1:</label>
        <input type="text" id="Pokemon1" class="pokemon-fields"><br>
        
        <label for="Pokemon1" class="pokemon-fields">Pokemon1:</label>
        <input type="text" id="Pokemon2" class="pokemon-fields"><br>



        <input type="text" id="" placeholder="tablename" class="form-control" autocomplete="off">

        <button onclick="submitForm()" id="s">Submit</button>
        <button onclick="cancelForm()" id="cancelButton">Cancel</button>
      </div>
    </div>

<script>
  var addButton = document.getElementById('insert');
  var modal = document.getElementById('myModal');
  var modalContent = document.getElementById('modalContent');
  var tableBody = document.querySelector('#myTable tbody');
  var searchInput = document.getElementById('searchInput');

  function addButtonClick() {
      if (modal.style.display === 'block') {
          return;
      }

      // Check the search term and display the appropriate fields and labels
      var searchTerm = searchInput.value.toLowerCase();
      if (searchTerm === 'people') {
          document.querySelectorAll('.people-fields').forEach(function(element) {
              element.style.display = 'block';
          });
          document.querySelectorAll('.user-fields').forEach(function(element) {
              element.style.display = 'none';
          });
          document.querySelectorAll('.pokemon-fields').forEach(function(element) {
              element.style.display = 'none';
          });
          modal.style.display = 'block';

      } 
    else  if(searchTerm == 'pokemon'){
        document.querySelectorAll('.pokemon-fields').forEach(function(element) {
              element.style.display = 'block';
          });
          document.querySelectorAll('.user-fields').forEach(function(element) {
              element.style.display = 'none';
          });
          document.querySelectorAll('.people-fields').forEach(function(element) {
              element.style.display = 'none';
          });
          modal.style.display = 'block';


      }
     else if(searchTerm == 'user') {
          document.querySelectorAll('.user-fields').forEach(function(element) {
              element.style.display = 'block';
          });
          document.querySelectorAll('.people-fields').forEach(function(element) {
              element.style.display = 'none';
          });
          document.querySelectorAll('.pokemon-fields').forEach(function(element) {
              element.style.display = 'none';
          });
          modal.style.display = 'block';

      }
      else{
        alert('Type table name to insert data');
      }

  }

  function submitForm() {
      var username = document.getElementById('username').value;
      var password = document.getElementById('password').value;
      var name = document.getElementById('name').value;
      var age = document.getElementById('age').value;

      // Use the entered values based on the displayed fields
      var value1 = (name && age) ? name : username;
      var value2 = (name && age) ? age : password;

      if (value1 && value2&& !age &&!name) {
          // Create a new table row
          var newRow = tableBody.insertRow();
          
          // Insert cells with the entered values
          var cell1 = newRow.insertCell(0);
          var cell2 = newRow.insertCell(1);

          cell1.textContent = value1;
          cell2.textContent = value2;

          // Make an AJAX request to the server to insert data
          fetch('/register', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify({ username, password })
          })
          .then(response => response.json())
          .then(data => {
              if (data.success) {
                  // Hide the modal after successful submission
                  modal.style.display = 'none';
              } else {
                  alert('Error inserting data into the database.');
              }
          })
          .catch(error => console.error('Error:', error));
      } 
      
      else {
          alert('Please fill out all fields.');
      }
  }

  function cancelForm() {
      // Clear the fields and hide the modal
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
      document.getElementById('name').value = '';
      document.getElementById('age').value = '';

      document.getElementById('username').style.display = 'none';
      document.getElementById('password').style.display = 'none';
      document.getElementById('name').style.display = 'none';
      document.getElementById('age').style.display = 'none';

      modal.style.display = 'none';
  }

  addButton.addEventListener('click', addButtonClick);
  document.getElementById('s').addEventListener('click', submitForm);
  document.getElementById('cancelButton').addEventListener('click', cancelForm);
</script>

</body>
</html>
